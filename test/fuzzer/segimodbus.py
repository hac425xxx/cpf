#!/usr/bin/python
# -*- coding: UTF-8 -*-

from cpf.fuzzer.TCPFuzzer import TCPFuzzer

if __name__ == '__main__':

    fuzzer = TCPFuzzer(host="192.168.245.135", port=27700,
                       nomal_trans_conf="../conf/seigmodbus.json",
                       sample_path="../sample/common/",
                       logseq_count=3, interval=0.02)

    relay = False

    if not relay:
        fuzzer.fuzz(mutate_max_count=10)
    else:

        seqs = [[{"recv": "",
                  "send": "00aabb20df202000bbaa00bb2020202020202020202020202020202020202020204173501834320500"}], [
                    {"recv": "",
                     "send": "00000000000ddd0aa0a00000000ea0df0a3f3f3f3f13c8a7bcbed798791324401e0f7f3ce6cc364f7ba1badfcf3b7955fb63dded1eeb3547d29f0127cdcaef95d6b41d56206bc46c371d692b0720202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020717d3a01a5f93d0a5790881c79c8bde217d8db8aad20e72dc7b079e396ff9301c10fd82f3ec5d86bad11dbe54d4d8a49f126e09be93fce38209055469fa2cfa231833ec3faa775293a0ebee6b4a9594d3b8e06d25759518531437dad2f79618fd3b746a2d557fe5c32978889a7d3292ef99c0c7ae54ad15599f86715d1f733a5cbde49fe00469603d0b66331ee487e24df5e76893e762aef34660e3060474ff8ff06a5d4fea8bc2b3dfa5d0bf0a19f91eab731bb15f1f7ec8fdf1ebe50f4f07a4a492a31ed8afefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefe202020bbe3f9f5cc02b413e61103c6f6f7ffb388527bfef99b1b8827f4dd33e1d33b051f39b285962afb39f3714d4be2edb234efad507796b464bc081242b39a0bee238f72d0bc175c900d108279e057bd7e1b36821be42452c356d320202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020205599f86715d1f733a5cbde49fe00469603d0b66331ee487e24df5e76893e762aef34660e3060474ff8ff06a5d4fea8bc2b3dfa5d0bf0a19f91eab731bb15f1f7ec8fdf1ebe50f4f07a4a492a31ed8afefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefefe202020bbe3f9f5cc02b413e61103c6f6f7ffb388527bfef99b1b8827f4dd33e1d33b051f39b285962afb39f3714d4be2edb234efad507796b464bc081242b39a0bee238f72d0bc175c900d108279e057bd7e1b36821be42452c356d3202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020a02020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020200aeb86c43ebb3e3ff2cfea9be358a326d3d9966e860274b71ecc16ad5829cae43a504eb03b7aba99de"}],
                [{"recv": "", "send": "206882476a594c1726a94f1fd529ec2da72ddac90212b5202020202020202020"}]]

        for seq in seqs:
            print fuzzer.check_vuln(seq)
